const modelurl="./models/border.glb",modelurl2="./models/dots.glb",line6="./models/line6.glb",loadModel=e=>new Promise((i,o)=>{const t=new THREE.LoadingManager;new THREE.GLTFLoader(t).load(e,function(e){i(e.scene)},function(e){},function(e){console.log(e)})});window.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);let shield1StartPosition=null,shield2StartPosition=null,shield3StartPosition=null;const sceneMeshes=[];let composer,shield1,shield2,shield3,line1,line2,line3,line4,plane1,plane2,plane3;window.modelDots=[];let shield1Pivot=new THREE.Object3D,shield2Pivot=new THREE.Object3D,shield3Pivot=new THREE.Object3D,lockShiled1=isMobile,lockShiled2=isMobile,lockShiled3=isMobile,lockLookShieled=!1,rotationPivot=!0,scene=new THREE.Scene;if(isMobile){const e=(new THREE.TextureLoader).load("textures/stars.jpg");scene.background=e}else{const e=(new THREE.CubeTextureLoader).load(["textures/NewSkyboxFace4.jpg","textures/NewSkyboxFace5.jpg","textures/NewSkyboxFace2.jpg","textures/NewSkyboxFace6.jpg","textures/NewSkyboxFace1.jpg","textures/NewSkyboxFace3.jpg"]);scene.background=e}let camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,1e3);scene.add(camera);let renderer=new THREE.WebGLRenderer({antialias:!0});renderer.setPixelRatio(2.3),renderer.setSize(window.innerWidth,window.innerHeight),renderer.toneMapping=THREE.ReinhardToneMapping,renderer.toneMappingExposure=Math.pow(1.1,1.1),document.getElementById("background").appendChild(renderer.domElement);const pointLight=new THREE.PointLight(16777215,1.7);camera.add(pointLight),camera.position.z=70,camera.position.y=10,window.step=1;let pivot=new THREE.Object3D;scene.add(pivot);const renderScene=new THREE.RenderPass(scene,camera),bloomPass=new THREE.UnrealBloomPass(new THREE.Vector2(window.innerWidth,window.innerHeight),1.5,.4,.85);bloomPass.threshold=0,bloomPass.strength=1.1,bloomPass.radius=0,(composer=new THREE.EffectComposer(renderer)).addPass(renderScene),composer.addPass(bloomPass);const effectFXAA=new THREE.ShaderPass(THREE.FXAAShader);effectFXAA.uniforms.resolution.value.x=1/(window.innerWidth*renderer.getPixelRatio()),effectFXAA.uniforms.resolution.value.y=1/(window.innerHeight*renderer.getPixelRatio()),composer.addPass(effectFXAA);let material=new THREE.MeshStandardMaterial({color:46079,side:THREE.DoubleSide}),materialGreen=new THREE.MeshStandardMaterial({color:65280,side:THREE.DoubleSide}),customMaterial=new THREE.ShaderMaterial({uniforms:{s:{type:"f",value:-1},b:{type:"f",value:1},p:{type:"f",value:2},glowColor:{type:"c",value:new THREE.Color("#00b3ff")}},vertexShader:document.getElementById("vertexShader").textContent,fragmentShader:document.getElementById("fragmentShader").textContent,side:THREE.DoubleSide,blending:THREE.AdditiveBlending,transparent:!1}),customMaterialWhite=customMaterial.clone();customMaterialWhite.uniforms.glowColor.value.set(new THREE.Color("#ffffff"));let fixY=-12.5;loadModel(modelurl).then(e=>{pivot.add(e),e.position.y=fixY,e.traverse(e=>{e.isMesh&&(e.material=customMaterial)})}),loadModel(modelurl2).then(e=>{pivot.add(e),e.position.y=fixY,e.traverse(e=>{e.isMesh&&(e.material=material)}),e.children[5].material=customMaterialWhite,e.children[4].material=customMaterialWhite,e.children[6].material=customMaterialWhite,e.children[5].visible=!1,e.children[4].visible=!1,e.children[6].visible=!1,modelDots=e}),isMobile||loadModel(line6).then(e=>{e.traverse(e=>{e.isMesh&&(e.material=material)});let i=e.clone();i.scale.set(1.85,1.85,1.85);let o=new THREE.Object3D;o.add(i),o.rotation.z=Math.PI/4,line1=i,scene.add(o),(i=e.clone()).scale.set(1.85,1.85,1.85),(o=new THREE.Object3D).add(i),o.rotation.z=-Math.PI/4,line2=i,scene.add(o),(i=e.clone()).scale.set(1.25,1.25,1.25),(o=new THREE.Object3D).add(i),o.rotation.z=Math.PI/2,line3=i,scene.add(o),(i=e.clone()).scale.set(1.25,1.25,1.25),(o=new THREE.Object3D).add(i),o.position.y=5,line4=i,scene.add(o)});let shield1l=new THREE.Object3D;shield1l.position.y=fixY,shield1l.position.x=16.5,shield1l.position.z=.5,shield1l.visible=!1;let shield2l=shield1l.clone(),shield3l=shield1l.clone();shield1=shield1l,shield3=shield3l,(shield2=shield2l).position.x=-23.5,shield2.position.y=0,shield3.position.y=26,shield3.position.x=0,shield1Pivot.add(shield1),shield2Pivot.add(shield2),shield3Pivot.add(shield3),scene.add(shield1Pivot),scene.add(shield2Pivot),scene.add(shield3Pivot),shield1StartPosition={x:shield1.position.x,y:shield1.position.y,z:shield1.position.z},shield2StartPosition={x:shield2l.position.x,y:shield2l.position.y,z:shield2l.position.z},shield3StartPosition={x:shield3l.position.x,y:shield3l.position.y,z:shield3l.position.z};let shieldPivotRotationZ=0;const animate=()=>{requestAnimationFrame(animate),rotationPivot&&(pivot.rotation.y+=.01),(shieldPivotRotationZ+=.01)>=2*Math.PI&&(shieldPivotRotationZ=0),shieldPivotRotationZ+=.01,line1&&(line1.rotation.y+=.026),line2&&(line2.rotation.y-=.016),line3&&(line3.rotation.y+=.026,1==step?line3.scale.set(0,0,0):line3.scale.set(1.25,1.25,1.25)),line4&&(line4.rotation.y-=.016),lockShiled1||(shield1Pivot.rotation.z=shieldPivotRotationZ),lockShiled2||(shield2Pivot.rotation.z=shieldPivotRotationZ),lockShiled3||(shield3Pivot.rotation.z=shieldPivotRotationZ),composer.render(),TWEEN.update()};animate();let tasks=[];const clearTasks=()=>{TWEEN.removeAll();for(let e=-0;e<tasks.length;e++)clearTimeout(tasks[e])},cameraSetup=(e,i)=>{new TWEEN.Tween(camera.rotation).to(e,i||2e3).start()};function sphere(e){let i;return e.updateMatrixWorld(),e.geometry.computeBoundingSphere(),(i=e.geometry.boundingSphere.clone()).applyMatrix4(e.matrixWorld),i}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}window.step1=(()=>{rotationPivot=!0,clearTasks();let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:0,y:15,z:20},2e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).start()}),window.step2=(()=>{rotationPivot=!0,modelDots.children[2].visible=!0,modelDots.children[5].visible=!1,clearTasks(),cameraSetup({x:0,y:0,z:0},1450);let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:-20,y:0,z:80},3e3).easing(TWEEN.Easing.Cubic.Out).onComplete(function(){}).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).start(),lockShiled2=!1,lockLookShieled=!1}),window.step3=(()=>{rotationPivot=!1,modelDots.children[1].visible=!0,modelDots.children[4].visible=!1,modelDots.children[0].visible=!0,modelDots.children[6].visible=!1,clearTasks(),cameraSetup({x:0,y:0,z:0},1450),new TWEEN.Tween(pivot.rotation).to({x:0,y:0,z:0},1500).start();let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};pivot.rotation.x=0,pivot.rotation.y=0,pivot.rotation.z=0,new TWEEN.Tween(e).to({x:-10,y:0,z:35},1500).easing(TWEEN.Easing.Cubic.Out).onComplete(function(){}).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).onComplete(function(){modelDots.children[2].visible=!1,modelDots.children[5].visible=!0,new TWEEN.Tween(pivot.rotation).to({x:0,y:1.3,z:.8},1500).start()}).start(),shield2.position.copy(shield2StartPosition),lockShiled2=!1,lockLookShieled=!1}),window.step4=(()=>{rotationPivot=!0,modelDots.children[2].visible=!0,modelDots.children[5].visible=!1,modelDots.children[1].visible=!0,modelDots.children[4].visible=!1,clearTasks(),cameraSetup({x:0,y:0,z:0},1450),lockShiled2=!1,lockLookShieled=!1,shield1.position.z=0,shield1.position.x=6,shield1.position.y=20,shield2Pivot.rotation.z=0,lockShiled2=!1,shield2.position.z=.5,shield2.position.x=20,shield2.position.y=12,lockShiled3=!1,shield3.position.z=0,shield3.position.x=25.8,shield3.position.y=-3;let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:30,y:10,z:80},3e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).start()}),window.step5=(()=>{rotationPivot=!1,clearTasks();let e=camera.clone();new THREE.Vector3(camera.position.x,camera.position.y,camera.position.z);const i=sphere(modelDots.children[1]).center.normalize(),o=.28*e.position.length();e.position.copy(i).normalize().multiplyScalar(o);const t=new THREE.Vector3(e.position.x,e.position.y,e.position.z);shield2.position.x=24,shield2.position.y=0,shield2.position.z=.7,lockShiled2=!0,lockLookShieled=!0;let n={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(camera.rotation).to({x:0,y:-.2,z:0},500).onComplete(function(){new TWEEN.Tween(n).to({z:2,x:58,y:0},1500).delay(500).onUpdate(function(){camera.position.set(n.x,n.y,n.z),shield2.lookAt(camera.position),camera.lookAt(shield2.position)}).onComplete(function(){new TWEEN.Tween(camera.position).to(t,500).onUpdate(function(){shield2.lookAt(camera.position),camera.lookAt(i)}).onComplete(function(){modelDots.children[1].visible=!1,modelDots.children[4].visible=!0}).start()}).start()}).start(),cameraSetup({x:-.2347317536273475,y:.07404189755525604,z:.017688367787720344},1e3),new TWEEN.Tween(shield2Pivot.rotation).onUpdate(function(){shield2.lookAt(camera.position)}).to({z:0},500).start()}),window.step6=(()=>{rotationPivot=!0,modelDots.children[1].visible=!0,modelDots.children[4].visible=!1,modelDots.children[0].visible=!0,modelDots.children[6].visible=!1,clearTasks(),cameraSetup({x:0,y:0,z:0},1450);let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:-20,y:0,z:80},3e3).easing(TWEEN.Easing.Cubic.Out).onComplete(function(){}).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).start(),shield2.position.copy(shield2StartPosition),lockShiled2=!1,lockLookShieled=!1}),window.step7=(()=>{clearTasks(),rotationPivot=!1,shield2.position.x=23.5,shield2.position.y=0,shield2.position.z=.5,lockShiled2=!0,lockLookShieled=!0;let e=camera.clone();new THREE.Vector3(camera.position.x,camera.position.y,camera.position.z);const i=sphere(modelDots.children[0]).center.normalize(),o=.38*e.position.length();e.position.copy(i).normalize().multiplyScalar(o);const t=new THREE.Vector3(e.position.x,e.position.y,e.position.z);new TWEEN.Tween(camera.position).to({z:80,x:28,y:0},500).onComplete(function(){new TWEEN.Tween(camera.position).to({z:.5,x:48,y:0},500).onUpdate(function(){shield2.lookAt(camera.position),camera.lookAt(shield2.position)}).onComplete(function(){new TWEEN.Tween(camera.position).to(t,2e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){shield2.lookAt(camera.position),camera.lookAt(shield2.position),camera.lookAt(i)}).onComplete(function(){modelDots.children[0].visible=!1,modelDots.children[6].visible=!0}).start()}).start()}).start(),new TWEEN.Tween(shield2Pivot.rotation).onUpdate(function(){shield2.lookAt(camera.position)}).to({z:0},1e3).start()}),window.step8=(()=>{rotationPivot=!0,modelDots.children[0].visible=!0,modelDots.children[6].visible=!1,clearTasks(),cameraSetup({x:-.2,y:0,z:0},1050),lockShiled2=!1,lockLookShieled=!1,shield1.position.z=0,shield1.position.x=6,shield1.position.y=20,shield2Pivot.rotation.z=0,lockShiled2=!1,shield2.position.z=.5,shield2.position.x=20,shield2.position.y=12,lockShiled3=!1,shield3.position.z=1,shield3.position.x=25.8,shield3.position.y=-3;let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:30,y:10,z:80},3e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).start(),new TWEEN.Tween(shield1Pivot.scale).to({x:1,y:1,z:1},1e3).start(),new TWEEN.Tween(shield2Pivot.scale).to({x:1,y:1,z:1},1e3).start(),new TWEEN.Tween(shield3Pivot.scale).to({x:1,y:1,z:1},1e3).start()}),window.step9=(()=>{rotationPivot=!0,clearTasks(),cameraSetup({x:0,y:0,z:0},1050);let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:-23,y:5,z:75},3e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).start(),new TWEEN.Tween(shield1Pivot.scale).to({x:10,y:10,z:10},1e3).start(),new TWEEN.Tween(shield2Pivot.scale).to({x:10,y:10,z:10},1e3).start(),new TWEEN.Tween(shield3Pivot.scale).to({x:10,y:10,z:10},1e3).start()}),window.mobileStep1=(()=>{console.log("step = 1 started"),rotationPivot=!0,clearTasks();let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:0,y:15,z:20},2e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).start()}),window.mobileStep2=(()=>{rotationPivot=!0,modelDots.children[1].visible=!1,modelDots.children[2].visible=!1,modelDots.children[4].visible=!1,modelDots.children[5].visible=!1,modelDots.children[6].visible=!1,clearTasks(),cameraSetup({x:0,y:0,z:0},1450);let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(pivot.rotation).to({y:0,x:0},2e3).easing(TWEEN.Easing.Cubic.Out).start(),new TWEEN.Tween(e).to({x:0,y:20,z:100},2e3).easing(TWEEN.Easing.Cubic.Out).onComplete(function(){}).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).start(),lockShiled2=!1,lockLookShieled=!1}),window.mobileStep3=(()=>{rotationPivot=!1,modelDots.children[0].visible=!1,modelDots.children[1].visible=!1,modelDots.children[2].visible=!1,modelDots.children[4].visible=!1,modelDots.children[5].visible=!1,modelDots.children[6].visible=!1,clearTasks(),lockShiled2=!0,lockLookShieled=!0,shield2.position.copy(shield2StartPosition),cameraSetup({x:0,y:0,z:0},2e3);let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:0,y:10,z:80},2e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).onComplete(function(){new TWEEN.Tween(pivot.rotation).to({y:1.6,x:.5},2e3).easing(TWEEN.Easing.Cubic.Out).onComplete(function(){modelDots.children[2].visible=!1,modelDots.children[5].visible=!0}).start()}).start()}),window.mobileStep4=(()=>{rotationPivot=!1,modelDots.children[0].visible=!1,modelDots.children[1].visible=!1,modelDots.children[2].visible=!1,modelDots.children[4].visible=!1,modelDots.children[5].visible=!1,modelDots.children[6].visible=!1,clearTasks(),lockShiled2=!0,lockLookShieled=!0,shield2.position.copy(shield2StartPosition),cameraSetup({x:0,y:0,z:0},2e3);let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:0,y:10,z:80},2e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).onComplete(function(){new TWEEN.Tween(pivot.rotation).to({y:3.9,x:.5},2e3).easing(TWEEN.Easing.Cubic.Out).onComplete(function(){modelDots.children[1].visible=!1,modelDots.children[4].visible=!0}).start()}).start()}),window.mobileStep5=(()=>{rotationPivot=!1,modelDots.children[0].visible=!1,modelDots.children[1].visible=!1,modelDots.children[2].visible=!1,modelDots.children[4].visible=!1,modelDots.children[5].visible=!1,modelDots.children[6].visible=!1,clearTasks(),lockShiled2=!0,lockLookShieled=!0,shield2.position.copy(shield2StartPosition),cameraSetup({x:0,y:0,z:0},2e3);let e={x:camera.position.x,y:camera.position.y,z:camera.position.z};new TWEEN.Tween(e).to({x:0,y:10,z:80},2e3).easing(TWEEN.Easing.Cubic.Out).onUpdate(function(){camera.position.set(e.x,e.y,e.z)}).onComplete(function(){new TWEEN.Tween(pivot.rotation).to({y:2.9,x:2},2e3).easing(TWEEN.Easing.Cubic.Out).onComplete(function(){modelDots.children[0].visible=!1,modelDots.children[6].visible=!0}).start()}).start()}),window.addEventListener("resize",onWindowResize);